import{j as T,a as q,F as J,B as w,i as Q,l as C,A as g,I as S,S as U,D as F,y as E,b as H,M as L,c as k,d as X,e as z,G as _,f as x,T as Y,H as Z,g as $,C as ee,h as M,k as te,m as ne,n as re,o as oe,_ as O,r as se,p as P,q as B,s as ae,t as ie,u as N,R as D,E as ce,v as le,w as de,Q as ue,x as me,V as fe,z as V,J as he,K as pe,L as ge,X as ve}from"./vendor.1dce61c2.js";const be=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}};be();const t=T,m=q,I=J,we=({mode:n,value:e,setValue:r,theme:s})=>t(w,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",children:t(Q,{defaultLanguage:n,theme:s,options:{minimap:{enabled:!1}},onChange:r,value:e,width:"100%",height:"70vh"})}),ye=(n,e)=>{const[r,s]=C(n);return E(()=>{let i=n.concat([]);n.forEach(a=>{a.type==="option"&&a.suboptions&&e&&Object.keys(e).forEach(o=>{const u=e[o];u&&a?.suboptions?.[u]&&(i=i.concat(a.suboptions[u]))})}),s(i)},[e,s,n]),[r]},Se=({hashkey:n,options:e})=>{const[r,s]=C(!1),i=g(()=>{s(!r)},[r]);return m(I,{children:[t(S,{verticalAlign:"top","aria-label":"Metaframe settings",icon:t(U,{}),size:"md",onClick:i}),t(Ee,{hashkey:n,isOpen:r,setOpen:s,options:e})]})},Ee=({hashkey:n,isOpen:e,setOpen:r,options:s})=>{const[i,a]=F(n||"options",Object.fromEntries(s.filter(l=>l.default).map(l=>[l.name,l.default]))),[o,u]=C(i||{}),[y]=ye(s,o),[b,R]=C(void 0),W=g(l=>{const{name:h,value:c}=l.target;let f=s.concat([]);s.forEach(j=>{j.suboptions&&Object.values(j.suboptions).forEach(K=>f=f.concat(K))});const v=f.find(j=>j.name===h);if(!v){console.error(`No option found for name=${h}`);return}v.type==="boolean"?u({...o,[h]:c==="1"}):u({...o,[h]:c})},[o,u,s]),G=g(()=>{r(!e)},[r,e]),A=g(()=>{const l={};if(Object.keys(o).forEach(c=>{const f=s.find(v=>v.name===c);if(f&&f.validator&&f.type!=="boolean"){const v=f.validator(o[c]);v&&(l[c]=v)}}),Object.keys(l).length>0){R(l);return}R(void 0);const h={};Object.keys(o).forEach(c=>{const f=y.find(v=>v.name===c);o[c]!==void 0&&(f!==void 0?f.map?h[c]=f.map(o[c]):f.type==="boolean"?h[c]=o[c]===!0||o[c]==="1"||o[c]==="true":f.type==="number"?h[c]=typeof o[c]=="string"?parseFloat(o[c]):o[c]:h[c]=o[c]:h[c]=o[c])}),r(!e),a(h)},[r,e,s,o,y,a,R]);return E(()=>{if(!e)return;const l=h=>{h.key==="Enter"&&e&&A()};return window.addEventListener("keyup",l),()=>{window.removeEventListener("keyup",l)}},[A,e]),t(H,{placement:"top",onClose:A,isOpen:e,children:t(L,{children:m(k,{children:[t(X,{borderBottomWidth:"0px",children:"Configure metaframe (stored in URL hash params )"}),t(z,{children:t(w,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden",children:m(_,{templateColumns:"repeat(12, 1fr)",gap:6,children:[y.map(l=>m(I,{children:[t(x,{rowSpan:1,colSpan:4,children:t(w,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end",children:m(Y,{textAlign:"right",verticalAlign:"bottom",children:[l.displayName||l.name,":"]})})}),m(x,{rowSpan:1,colSpan:8,children:[" ",xe(l,o[l.name],W)]})]})),t(x,{rowSpan:1,colSpan:12}),t(x,{rowSpan:1,colSpan:12}),t(x,{rowSpan:1,colSpan:12}),t(x,{rowSpan:1,colSpan:12,children:m(Z,{spacing:2,direction:"row",children:[t($,{}),t(S,{size:"lg",color:"red",icon:t(ee,{}),onClick:G}),t(S,{size:"lg",color:"green",icon:t(M,{}),onClick:A})]})})]})})})]})})})},xe=(n,e,r)=>{switch(n.type){case"option":return t(re,{name:n.name,value:e,onChange:r,placeholder:"Select option",children:n.options.map(s=>t("option",{value:s,children:s}))});case"boolean":return t(ne,{name:n.name,rightIcon:t(M,{}),onChange:r,isChecked:e===!0||e==="1",value:e?0:1});default:return t(w,{w:"100%",h:"10",children:t(te,{name:n.name,type:"text",placeholder:"",value:e===void 0?n.default:e,onInput:r})})}};var d;(function(n){n[n.Start=0]="Start",n[n.Editing=1]="Editing",n[n.Running=2]="Running",n[n.Finished=3]="Finished"})(d||(d={}));const p=oe(n=>({code:void 0,result:void 0,mode:0,setCode:e=>n(r=>({code:e})),setResult:e=>n(r=>({result:e})),setMode:e=>n(r=>({mode:e}))})),Ce=()=>{const n=p(s=>s.mode),e=p(s=>s.result),[r]=O("presentation");return d.Running===n?t(se.BeatLoader,{size:8,color:"blue"}):!e||r?null:e.failure?m(I,{children:[m(P,{status:"error",children:[t(B,{}),m(ae,{mr:2,children:["Error",e?.failure?.phase?" in phase "+e.failure.phase:""]})]}),m(P,{status:"error",children:[t(B,{}),t(ie,{children:`${e.failure?.error}`})]})]}):t(P,{status:"success",children:t(B,{})})},Ie=Object.getPrototypeOf(async function(){}).constructor,Ae=(n,e)=>{let r=null,s=Object.keys(e);try{r=Ie("exports",`"use strict"; return (async function(${s.join(", ")}){${n}})`)({})}catch(a){return Promise.resolve({failure:{error:a,phase:"compile"}})}if(r){var i="exec";let a=Object.values(e);return r.apply?r.apply(null,a).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:i}})):r.then(o=>o.apply(null,a)).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:i}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},je=()=>{const n=N(),e=p(a=>a.setMode),r=p(a=>a.setResult),s=p(a=>a.result);return E(()=>()=>{if(s?.result&&typeof s?.result=="function")try{s.result()}catch(a){console.error("Failed to cancel without error:",a)}},[s]),[g(async a=>{if(!a||a.trim().length===0){e(d.Finished),r(void 0);return}if(!!n.metaframe){r(void 0);try{const o=await Ae(a,{metaframe:n.metaframe});r(o)}catch(o){console.error(o),r({failure:{error:o}})}e(d.Finished)}},[n.metaframe,e,r]),s]},Re=()=>{const n=N(),e=p(u=>u.mode),r=p(u=>u.setMode),s=p(u=>u.code),[i,a]=D("text",void 0),o=g(()=>{switch(e){case d.Editing:i!==s&&a(s),r(d.Running);break;case d.Finished:r(d.Editing);break;case d.Running:r(d.Editing);break;case d.Start:break}},[n.metaframe,s,i,a,e,r]);return t(S,{verticalAlign:"top","aria-label":"Help",colorScheme:e===d.Editing?"blue":void 0,icon:e===d.Editing?t(M,{}):t(ce,{}),size:"md",onClick:o,mr:"4"})},Me=({url:n})=>{const[e,r]=C(!(le()||de()[1].text!==void 0));n=n||`${window.location.origin}${window.location.pathname}/README.md`;const s=g(()=>{r(!e)},[e]);return m(I,{children:[t(S,{verticalAlign:"top","aria-label":"Help",icon:t(ue,{}),size:"md",onClick:s,mr:"4"}),t(Oe,{url:n,isOpen:e,setOpen:r})]})},Oe=({isOpen:n,setOpen:e,url:r})=>{console.log("isOpen",n);const s=g(()=>{e(!n)},[e,n]),i=g(()=>{e(!1)},[e]),a=`https://metapages.github.io/metaframe-markdown/#?url=${r}`;return t(H,{size:"full",placement:"top",onClose:s,isOpen:n,onOverlayClick:i,children:t(L,{children:m(k,{children:[t(me,{size:"lg",bg:"gray.100"}),t(z,{children:t("iframe",{width:"100%",height:"100%",src:a})})]})})})},Pe=()=>{const[n,e]=O("presentation",void 0),r=g(()=>{e(!n),window.location.reload()},[n,e]);return t(I,{children:t(S,{verticalAlign:"top","aria-label":"Help",icon:t(fe,{}),size:"md",onClick:r,mr:"4"})})},Be=[{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]},{name:"menuAtBottom",displayName:"Place menu bar at bottom of render content",default:!1,type:"boolean"}],Fe=()=>{const[n]=F("options",{theme:"light",menuAtBottom:!1}),[e]=O("presentation"),r=p(b=>b.code),s=p(b=>b.setCode),i=p(b=>b.mode),a=p(b=>b.setMode),[o]=je(),[u]=D("text",void 0);if(E(()=>{i===d.Start&&a(d.Running)},[i,a]),E(()=>{i===d.Running&&o&&o(r)},[i,r,o]),E(()=>{s(u),o&&o(u)},[u,s,o]),e)return t("div",{id:"render"});const y=m(V,{spacing:2,alignItems:"flex-start",children:[m(he,{width:"100%",children:[t(Re,{}),t($,{}),t(Pe,{}),t(Me,{}),t(Se,{options:Be})]}),t(Ce,{})]});return t(w,{w:"100%",p:2,children:m(V,{spacing:2,alignItems:"flex-start",children:[n?.menuAtBottom?null:t(w,{w:"100%",children:y}),i===d.Editing?t(w,{w:"100%",children:t(we,{mode:"javascript",theme:n?.theme||"light",setValue:s,value:r})}):t("div",{id:"render"}),n?.menuAtBottom?t(w,{w:"100%",children:y}):null]})})},He=()=>t(Fe,{});pe(t(ge,{children:t(ve,{children:t(He,{})})}),document.getElementById("root"));
//# sourceMappingURL=index.69fb21d2.js.map
