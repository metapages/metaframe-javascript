import{v as e,i as D,l as E,A as h,I as S,S as $,d as I,U as R,y as b,M as O,D as j,a as N,b as L,B as w,G as V,c as v,T as W,C as G,e as x,f as M,g as T,h as U,j as q,k as K,r as Q,m as k,n as A,o as J,p as X,q as P,E as B,s as Y,L as Z,Q as _,t as ee,V as F,F as te,u as ne,w as re,z as oe,x as ae}from"./vendor.a24743af.js";const se=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};se();const le=({mode:n,value:t,setValue:o,theme:a})=>e(D,{defaultLanguage:n,theme:a,options:{minimap:{enabled:!1}},onChange:o,value:t,width:"100%",height:"80vh"}),ie=({options:n})=>{const[t,o]=E(!1),a=h(()=>{o(!t)},[t]);return e(I,null,e(S,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e($,null),onClick:a}),e(ce,{isOpen:t,setOpen:o,options:n}))},ce=({isOpen:n,setOpen:t,options:o})=>{const[a,s]=R("options",Object.fromEntries(o.filter(i=>i.default).map(i=>[i.name,i.default]))),[r,l]=E(a||{}),[g,m]=E(void 0),H=h(i=>{const{name:p,value:u}=i.target;o.find(y=>y.name===p).type==="boolean"?l({...r,[p]:u==="1"}):l({...r,[p]:u})},[r,l]),z=h(()=>{t(!n)},[t,n]),C=h(()=>{const i={};if(Object.keys(r).forEach(u=>{const f=o.find(y=>y.name===u);if(f&&f.validator&&f.type!=="boolean"){const y=f.validator(r[u]);y&&(i[u]=y)}}),Object.keys(i).length>0){m(i);return}m(void 0);const p={};Object.keys(r).forEach(u=>{const f=o.find(y=>y.name===u);f&&f.map?p[u]=f.map(r[u]):p[u]=r[u]}),t(!n),s(p)},[t,n,o,r,s,m]);return b(()=>{const i=p=>{p.key==="Enter"&&n&&C()};return window.addEventListener("keyup",i),()=>{window.removeEventListener("keyup",i)}},[C,n]),e(M,{placement:"top",onClose:C,isOpen:n},e(O,null,e(j,null,e(N,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(L,null,e(w,{maxW:"100%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(V,{templateColumns:"repeat(12, 1fr)",gap:6},o.map(i=>e(I,null,e(v,{rowSpan:1,colSpan:4},e(w,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e(W,{textAlign:"right",verticalAlign:"bottom"},i.displayName||i.name,":"))),e(v,{rowSpan:1,colSpan:8}," ",ue(i,r[i.name],H)))),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:10}),e(v,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"red",icon:e(G,null),onClick:z})),e(v,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"green",icon:e(x,null),onClick:C}))))))))},ue=(n,t,o)=>{switch(n.type){case"option":return e(q,{name:n.name,value:t,onChange:o,placeholder:"Select option"},n.options.map(a=>e("option",{value:a},a)));case"boolean":return e(U,{name:n.name,rightIcon:e(x,null),onChange:o,isChecked:t===!0||t==="1",value:t?0:1});default:return e(w,{w:"100%",h:"10"},e(T,{name:n.name,type:"text",placeholder:"",value:t,onInput:o}))}};var c;(function(n){n[n.Start=0]="Start",n[n.Editing=1]="Editing",n[n.Running=2]="Running",n[n.Finished=3]="Finished"})(c||(c={}));const d=K(n=>({code:void 0,result:void 0,mode:0,setCode:t=>n(o=>({code:t})),setResult:t=>n(o=>({result:t})),setMode:t=>n(o=>({mode:t}))})),de=()=>{const n=d(o=>o.mode),t=d(o=>o.result);return c.Running===n?e(Q.BeatLoader,{size:8,color:"blue"}):t?t.failure?e(I,null,e(k,{status:"error"},e(A,null),e(X,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(k,{status:"error"},e(A,null),e(J,null,`${t.failure?.error}`))):e(k,{status:"success"},e(A,null)):null},me=Object.getPrototypeOf(async function(){}).constructor,pe=(n,t)=>{let o=null,a=Object.keys(t);try{o=me("exports",`"use strict"; return (async function(${a.join(", ")}){${n}})`)({})}catch(r){return Promise.resolve({failure:{error:r,phase:"compile"}})}if(o){var s="exec";let r=Object.values(t);return o.apply?o.apply(null,r).then(l=>({result:l})).catch(l=>({failure:{error:l,phase:s}})):o.then(l=>l.apply(null,r)).then(l=>({result:l})).catch(l=>({failure:{error:l,phase:s}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},fe=()=>{const n=P(),t=d(r=>r.setMode),o=d(r=>r.setResult),a=d(r=>r.result);return b(()=>()=>{if(a?.result&&typeof a?.result=="function")try{a.result()}catch(r){console.error("Failed to cancel without error:",r)}},[a]),[h(async r=>{if(!r||r.trim().length===0){t(c.Finished),o(void 0);return}if(!!n.metaframe){o(void 0);try{const l=await pe(r,{metaframe:n.metaframe});o(l)}catch(l){console.error(l),o({failure:{error:l}})}t(c.Finished)}},[n.metaframe,t,o]),a]},he=()=>{const n=P(),t=d(g=>g.mode),o=d(g=>g.setMode),a=d(g=>g.code),[s,r]=B("text",void 0),l=h(()=>{switch(t){case c.Editing:s!==a&&r(a),o(c.Running);break;case c.Finished:o(c.Editing);break;case c.Running:o(c.Editing);break;case c.Start:break}},[n.metaframe,a,s,r,t,o]);return e(S,{verticalAlign:"top","aria-label":"Help",colorScheme:t===c.Editing?"blue":void 0,icon:t===c.Editing?e(x,null):e(Y,null),size:"md",onClick:l,mr:"4"})},ge=({url:n})=>{const[t,o]=E(!Z());n=n||`${window.location.origin}${window.location.pathname}/README.md`;const a=h(()=>{o(!t)},[t]);return e(I,null,e(S,{verticalAlign:"top","aria-label":"Help",icon:e(_,null),size:"md",onClick:a,mr:"4"}),e(ye,{url:n,isOpen:t,setOpen:o}))},ye=({isOpen:n,setOpen:t,url:o})=>{const a=h(()=>{t(!n)},[t,n]),s=h(()=>{t(!1)},[t]),r=`https://metapages.github.io/metaframe-markdown/#?url=${o}`;return e(M,{size:"full",placement:"top",onClose:a,isOpen:n,onOverlayClick:s},e(O,null,e(j,null,e(ee,{size:"lg",bg:"gray.100"}),e(L,null,e("iframe",{width:"100%",height:"100%",src:r})))))},ve=[{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]}],we=()=>{const[n]=R("options",{theme:"light"}),t=d(m=>m.code),o=d(m=>m.setCode),a=d(m=>m.mode),s=d(m=>m.setMode),[r]=fe(),[l]=B("text",void 0);b(()=>{a===c.Start&&s(c.Running)},[a,s]),b(()=>{a===c.Running&&r&&r(t)},[a,t,r]),b(()=>{o(l),r&&r(l)},[l,o,r]);const g=e(F,{spacing:2,alignItems:"flex-start"},e(te,{width:"100%"},e(he,null),e(ne,null),e(ge,null),e(ie,{options:ve})),e(de,null));return e(w,{w:"100%",p:2},e(F,{spacing:2,alignItems:"flex-start"},a===c.Editing?e(w,{w:"100%"},e(le,{mode:"javascript",theme:n?.theme||"light",setValue:o,value:t})):e("div",{id:"render"}),e(w,{w:"30%"},g)))};re(e(ae,null,e(oe,null,e(we,null))),document.getElementById("root"));
//# sourceMappingURL=index.933d4299.js.map
