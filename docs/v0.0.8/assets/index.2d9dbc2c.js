import{v as e,i as D,l as w,A as p,I as S,S as F,d as b,u as E,y as I,M as A,D as H,a as N,b as O,B as y,G as W,c as g,T as $,C as V,e as P,f as R,g as G,h as J,j as T,k as q,r as K,m as x,n as k,o as Q,p as U,q as j,s as B,t as X,w as Y,Q as Z,x as _,H as ee,F as te,z as ne,V as re,E as oe,W as ae,J as se}from"./vendor.831df2f6.js";const le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};le();const ie=({mode:r,value:t,setValue:n,theme:l})=>e(D,{defaultLanguage:r,theme:l,options:{minimap:{enabled:!1}},onChange:n,value:t,width:"100%",height:"99vh"}),ce=({options:r})=>{const[t,n]=w(!1),l=p(()=>{n(!t)},[t]);return e(b,null,e(S,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e(F,null),onClick:l}),e(ue,{isOpen:t,setOpen:n,options:r}))},ue=({isOpen:r,setOpen:t,options:n})=>{const[l,s]=E("options",Object.fromEntries(n.filter(i=>i.default).map(i=>[i.name,i.default]))),[a,o]=w(l||{}),[c,C]=w(void 0),L=p(i=>{const{name:m,value:u}=i.target;n.find(h=>h.name===m).type==="boolean"?o({...a,[m]:u==="1"}):o({...a,[m]:u})},[a,o]),z=p(()=>{t(!r)},[t,r]),v=p(()=>{const i={};if(Object.keys(a).forEach(u=>{const f=n.find(h=>h.name===u);if(f&&f.validator&&f.type!=="boolean"){const h=f.validator(a[u]);h&&(i[u]=h)}}),Object.keys(i).length>0){C(i);return}C(void 0);const m={};Object.keys(a).forEach(u=>{const f=n.find(h=>h.name===u);f&&f.map?m[u]=f.map(a[u]):m[u]=a[u]}),t(!r),s(m)},[t,r,n,a,s,C]);return I(()=>{const i=m=>{m.key==="Enter"&&r&&v()};return window.addEventListener("keyup",i),()=>{window.removeEventListener("keyup",i)}},[v,r]),e(R,{placement:"top",onClose:v,isOpen:r},e(A,null,e(H,null,e(N,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(O,null,e(y,{maxW:"100%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(W,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(i=>e(b,null,e(g,{rowSpan:1,colSpan:4},e(y,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e($,{textAlign:"right",verticalAlign:"bottom"},i.displayName||i.name,":"))),e(g,{rowSpan:1,colSpan:8}," ",de(i,a[i.name],L)))),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:10}),e(g,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"red",icon:e(V,null),onClick:z})),e(g,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"green",icon:e(P,null),onClick:v}))))))))},de=(r,t,n)=>{switch(r.type){case"option":return e(T,{name:r.name,value:t,onChange:n,placeholder:"Select option"},r.options.map(l=>e("option",{value:l},l)));case"boolean":return e(J,{name:r.name,rightIcon:e(P,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return e(y,{w:"100%",h:"10"},e(G,{name:r.name,type:"text",placeholder:"",value:t,onInput:n}))}},d=q(r=>({code:void 0,result:void 0,running:!1,setCode:t=>r(n=>({code:t})),setResult:t=>r(n=>({result:t})),setRunning:t=>r(n=>({running:t}))})),me=()=>{const r=d(n=>n.running),t=d(n=>n.result);return r?e(K.BeatLoader,{size:8,color:"blue"}):t?t.failure?e(b,null,e(x,{status:"error"},e(k,null),e(U,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(x,{status:"error"},e(k,null),e(Q,null,`${t.failure?.error}`))):e(x,{status:"success"},e(k,null)):null},fe=Object.getPrototypeOf(async function(){}).constructor,pe=(r,t)=>{let n=null,l=Object.keys(t);try{n=fe("exports",`"use strict"; return (async function(${l.join(", ")}){${r}})`)({})}catch(a){return Promise.resolve({failure:{error:a,phase:"compile"}})}if(n){var s="exec";let a=Object.values(t);return n.apply?n.apply(null,a).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:s}})):n.then(o=>o.apply(null,a)).then(o=>({result:o})).catch(o=>({failure:{error:o,phase:s}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},M=()=>{const r=j(),t=d(o=>o.setRunning),n=d(o=>o.setResult),l=d(o=>o.result),s=d(o=>o.running);return I(()=>()=>{if(l?.result&&typeof l?.result=="function")try{l.result()}catch(o){console.error("Failed to cancel without error:",o)}},[l]),[p(async o=>{if(!o||o.trim().length===0){t(!1),n(void 0);return}if(!!r.metaframe){t(!0),n(void 0);try{const c=await pe(o,{metaframe:r.metaframe});n(c)}catch(c){console.error(c),n({failure:{error:c}})}t(!1)}},[r.metaframe,t,n]),s,l]},he=()=>{const r=j(),t=d(c=>c.running),n=d(c=>c.code),[l]=M(),[s,a]=B("text",void 0),o=p(()=>{s!==n?a(n):l&&l(n)},[r.setOutputs,t,n,s,l,a]);return e(X,{colorScheme:"blue",onClick:o},"Save + Run")},ge=({url:r})=>{const[t,n]=w(!Y());r=r||`${window.location.origin}${window.location.pathname}/README.md`;const l=p(()=>{n(!t)},[t]);return e(b,null,e(S,{verticalAlign:"top","aria-label":"Help",icon:e(Z,null),size:"md",onClick:l,mr:"4"}),e(ye,{url:r,isOpen:t,setOpen:n}))},ye=({isOpen:r,setOpen:t,url:n})=>{const l=p(()=>{t(!r)},[t,r]),s=p(()=>{t(!1)},[t]),a=`https://metapages.github.io/metaframe-markdown/#?url=${n}`;return e(R,{size:"full",placement:"top",onClose:l,isOpen:r,onOverlayClick:s},e(A,null,e(H,null,e(_,{size:"lg",bg:"gray.100"}),e(O,null,e("iframe",{width:"100%",height:"100%",src:a})))))},ve=[{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]},{name:"hideeditor",displayName:"Hide editor",default:!1,type:"boolean"}],we=()=>{const[r]=E("options",{theme:"light",hideeditor:!1}),t=d(c=>c.code),n=d(c=>c.setCode),[l]=M(),[s,a]=B("text",void 0);I(()=>{n(s),l&&l(s)},[s,n,l]);const o=e(re,{spacing:2,alignItems:"flex-start"},e(te,{width:"100%"},e(he,null),e(ne,null),e(ge,null),e(ce,{options:ve})),e(me,null));return e(y,{w:"100%",p:2},r?.hideeditor?o:e(ee,{spacing:2,alignItems:"flex-start"},e(y,{w:"70%"},e(ie,{mode:"javascript",theme:r?.theme||"light",setValue:n,value:t})),e(y,{w:"30%"},o)))};oe(e(se,null,e(ae,null,e(we,null))),document.getElementById("root"));
//# sourceMappingURL=index.2d9dbc2c.js.map
