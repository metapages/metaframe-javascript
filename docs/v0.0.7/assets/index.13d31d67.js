import{v as e,i as z,l as w,A as f,I as S,S as D,d as b,u as k,y as I,M as E,D as O,a as F,b as A,B as y,G as W,c as g,T as $,C as V,e as H,f as P,g as G,h as J,j as T,k as q,r as K,m as x,n as j,o as Q,p as U,q as R,s as B,t as X,w as Y,Q as Z,x as _,H as ee,F as te,z as ne,V as oe,E as re,W as ae,J as se}from"./vendor.831df2f6.js";const le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};le();const ie=({mode:o,value:t,setValue:n,theme:l})=>e(z,{defaultLanguage:o,theme:l,options:{minimap:{enabled:!1}},onChange:n,value:t,width:"100%",height:"99vh"}),ce=({options:o})=>{const[t,n]=w(!1),l=f(()=>{n(!t)},[t]);return e(b,null,e(S,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e(D,null),onClick:l}),e(ue,{isOpen:t,setOpen:n,options:o}))},ue=({isOpen:o,setOpen:t,options:n})=>{const[l,s]=k("options",Object.fromEntries(n.filter(i=>i.default).map(i=>[i.name,i.default]))),[a,r]=w(l||{}),[c,C]=w(void 0),L=f(i=>{const{name:m,value:u}=i.target;n.find(h=>h.name===m).type==="boolean"?r({...a,[m]:u==="1"}):r({...a,[m]:u})},[a,r]),N=f(()=>{t(!o)},[t,o]),v=f(()=>{const i={};if(Object.keys(a).forEach(u=>{const p=n.find(h=>h.name===u);if(p&&p.validator&&p.type!=="boolean"){const h=p.validator(a[u]);h&&(i[u]=h)}}),Object.keys(i).length>0){C(i);return}C(void 0);const m={};Object.keys(a).forEach(u=>{const p=n.find(h=>h.name===u);p&&p.map?m[u]=p.map(a[u]):m[u]=a[u]}),t(!o),s(m)},[t,o,n,a,s,C]);return I(()=>{const i=m=>{m.key==="Enter"&&o&&v()};return window.addEventListener("keyup",i),()=>{window.removeEventListener("keyup",i)}},[v,o]),e(P,{placement:"top",onClose:v,isOpen:o},e(E,null,e(O,null,e(F,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(A,null,e(y,{maxW:"100%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(W,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(i=>e(b,null,e(g,{rowSpan:1,colSpan:4},e(y,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e($,{textAlign:"right",verticalAlign:"bottom"},i.displayName||i.name,":"))),e(g,{rowSpan:1,colSpan:8}," ",de(i,a[i.name],L)))),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:12}),e(g,{rowSpan:1,colSpan:10}),e(g,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"red",icon:e(V,null),onClick:N})),e(g,{rowSpan:1,colSpan:1},e(S,{size:"lg",color:"green",icon:e(H,null),onClick:v}))))))))},de=(o,t,n)=>{switch(o.type){case"option":return e(T,{name:o.name,value:t,onChange:n,placeholder:"Select option"},o.options.map(l=>e("option",{value:l},l)));case"boolean":return e(J,{name:o.name,rightIcon:e(H,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return e(y,{w:"100%",h:"10"},e(G,{name:o.name,type:"text",placeholder:"",value:t,onInput:n}))}},d=q(o=>({code:void 0,result:void 0,running:!1,setCode:t=>o(n=>({code:t})),setResult:t=>o(n=>({result:t})),setRunning:t=>o(n=>({running:t}))})),me=()=>{const o=d(n=>n.running),t=d(n=>n.result);return o?e(K.BeatLoader,{size:8,color:"blue"}):t?t.failure?e(b,null,e(x,{status:"error"},e(j,null),e(U,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(x,{status:"error"},e(j,null),e(Q,null,`${t.failure?.error}`))):e(x,{status:"success"},e(j,null)):null},pe=Object.getPrototypeOf(async function(){}).constructor,fe=(o,t)=>{let n=null,l=Object.keys(t);try{n=pe("exports",`"use strict"; return (async function(${l.join(", ")}){${o}})`)({})}catch(a){return Promise.resolve({failure:{error:a,phase:"compile"}})}if(n){var s="exec";let a=Object.values(t);return n.apply?n.apply(null,a).then(r=>({result:r})).catch(r=>({failure:{error:r,phase:s}})):n.then(r=>r.apply(null,a)).then(r=>({result:r})).catch(r=>({failure:{error:r,phase:s}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},M=()=>{const o=R(),t=d(r=>r.setRunning),n=d(r=>r.setResult),l=d(r=>r.result),s=d(r=>r.running);return I(()=>()=>{if(l?.result&&typeof l?.result=="function")try{l.result()}catch(r){console.error("Failed to cancel without error:",r)}},[l]),[f(async r=>{if(!r||r.trim().length===0){t(!1),n(void 0);return}if(!!o.metaframe){t(!0),n(void 0);try{const c=await fe(r,{metaframe:o.metaframe});n(c)}catch(c){console.error(c),n({failure:{error:c}})}t(!1)}},[o.metaframe,t,n]),s,l]},he=()=>{const o=R(),t=d(c=>c.running),n=d(c=>c.code),[l]=M(),[s,a]=B("text",void 0),r=f(()=>{s!==n?a(n):l&&l(n)},[o.setOutputs,t,n,s,l,a]);return e(X,{colorScheme:"blue",onClick:r},"Save + Run")},ge=({url:o})=>{const[t,n]=w(!Y());o=o||`${window.location.origin}${window.location.pathname}/README.md`;const l=f(()=>{n(!t)},[t]);return e(b,null,e(S,{verticalAlign:"top","aria-label":"Help",icon:e(Z,null),size:"lg",onClick:l,mr:"4"}),e(ye,{url:o,isOpen:t,setOpen:n}))},ye=({isOpen:o,setOpen:t,url:n})=>{const l=f(()=>{t(!o)},[t,o]),s=f(()=>{t(!1)},[t]),a=`https://metapages.github.io/metaframe-markdown/#?url=${n}`;return e(P,{size:"full",placement:"top",onClose:l,isOpen:o,onOverlayClick:s},e(E,null,e(O,null,e(_,{size:"lg",bg:"gray.100"}),e(A,null,e("iframe",{width:"100%",height:"100%",src:a})))))},ve=[{name:"mode",displayName:"Editor code mode",default:"json",type:"option",options:["json","javascript","python","sh"]},{name:"noautorun",displayName:"Only run when Run is clicked",default:!1,type:"boolean"},{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]},{name:"hideeditor",displayName:"Hide editor",default:!1,type:"boolean"}],we=()=>{const[o]=k("options",{mode:"json",noautorun:!1,theme:"light",hideeditor:!1}),t=d(c=>c.code),n=d(c=>c.setCode),[l]=M(),[s,a]=B("text",void 0);I(()=>{n(s),l&&l(s)},[s,n,l]);const r=e(oe,{spacing:2,alignItems:"flex-start"},e(te,{width:"100%"},e(he,null),e(ne,null),e(ge,null),e(ce,{options:ve})),e(me,null));return e(y,{w:"100%",p:2},o?.hideeditor?r:e(ee,{spacing:2,alignItems:"flex-start"},e(y,{w:"70%"},e(ie,{mode:o?.mode||"json",theme:o?.theme||"light",setValue:n,value:t})),e(y,{w:"30%"},r)))};re(e(se,null,e(ae,null,e(we,null))),document.getElementById("root"));
//# sourceMappingURL=index.13d31d67.js.map
